# DJP Workflow - Environment Variables Example
# Sprint 57: Security Hardening - Production-Safe Defaults
#
# SECURITY HYGIENE GUIDELINES:
# 1. NEVER commit .env files with real secrets to version control
# 2. Use strong, randomly-generated secrets (32+ characters)
# 3. Rotate secrets regularly (every 90 days minimum)
# 4. Use different secrets for dev/staging/production
# 5. Store production secrets in secure secret management (Railway, AWS Secrets Manager, etc.)
# 6. Audit secret access logs regularly

# ============================================================================
# Core Application Settings
# ============================================================================

# Environment: local, staging, production
# Sprint 57: Used for production safety checks
RELAY_ENV=local

# Development auth bypass (Sprint 57: CHANGED DEFAULT TO FALSE FOR SECURITY)
# Set to "true" ONLY in local development - NEVER in production
# Production deployments will refuse to start if DEV_AUTH_MODE=true
DEV_AUTH_MODE=false

# ============================================================================
# Feature Flags
# ============================================================================

# Enable actions system
ACTIONS_ENABLED=true

# Enable telemetry and metrics
TELEMETRY_ENABLED=true

# Enable Google OAuth provider
PROVIDER_GOOGLE_ENABLED=false

# ============================================================================
# Security Secrets (Sprint 57)
# ============================================================================

# HMAC signing secret for webhook verification (Sprint 57 Step 5)
# If set, X-Signature header becomes REQUIRED on /actions/execute
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
# ACTIONS_SIGNING_SECRET=CHANGE_ME_USE_STRONG_RANDOM_SECRET

# OAuth token encryption key (Sprint 54)
# MUST be 32 bytes base64-encoded (Fernet key format)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# OAUTH_ENCRYPTION_KEY=CHANGE_ME_USE_FERNET_KEY

# ============================================================================
# Database
# ============================================================================

# PostgreSQL connection string
# Format: postgresql://user:password@host:port/database
# DATABASE_URL=postgresql://postgres:password@localhost:5432/djp_workflow

# ============================================================================
# Redis (Optional - for rate limiting and OAuth caching)
# ============================================================================

# Redis connection string
# Format: redis://[user:password@]host:port[/db]
# REDIS_URL=redis://localhost:6379

# ============================================================================
# External APIs
# ============================================================================

# OpenAI API key (for AI planning and DJP workflow)
# Get from: https://platform.openai.com/api-keys
# OPENAI_API_KEY=sk-proj-YOUR_KEY_HERE

# ============================================================================
# OAuth Providers
# ============================================================================

# Google OAuth credentials (Sprint 53)
# Get from: https://console.cloud.google.com/apis/credentials
# GOOGLE_CLIENT_ID=YOUR_CLIENT_ID.apps.googleusercontent.com
# GOOGLE_CLIENT_SECRET=YOUR_CLIENT_SECRET

# Public base URL for OAuth callbacks
# RELAY_PUBLIC_BASE_URL=https://your-domain.com

# ============================================================================
# Development Overrides
# ============================================================================

# Webhook URL for testing (Sprint 49)
# WEBHOOK_URL=https://webhook.site/your-test-id

# Rollout dry-run mode (prevents actual execution)
# ROLLOUT_DRY_RUN=false

# ============================================================================
# Sprint 57 Security Checklist
# ============================================================================
#
# Before deploying to production:
# [ ] DEV_AUTH_MODE=false (or unset)
# [ ] RELAY_ENV=production
# [ ] All secrets are strong and randomly generated
# [ ] ACTIONS_SIGNING_SECRET is set if using webhooks
# [ ] OAUTH_ENCRYPTION_KEY is set if using OAuth
# [ ] DATABASE_URL points to production database
# [ ] REDIS_URL points to production Redis (if used)
# [ ] .env file is in .gitignore
# [ ] Secrets are stored in secure secret manager
# [ ] Access logs are enabled and monitored

# ============================================================================
# CI/CD Environment Configuration
# ============================================================================
#
# GitHub Actions CI enforces these settings for test reliability:
#
# DEV_AUTH_MODE=false
#   - CI tests run with production-safe security defaults
#   - Ensures tests catch auth bypass issues before deployment
#   - Individual tests may override in setup_method() when needed
#
# RELAY_ENV=test
#   - Identifies test environment in logs and metrics
#   - Allows environment-specific behavior in tests
#   - Prevents accidental production side effects
#
# Why these defaults matter:
#   - Local dev can use DEV_AUTH_MODE=true for convenience
#   - CI must match production security posture to catch issues early
#   - Test failures in CI with DEV_AUTH_MODE=false indicate real problems
#
# See: .github/workflows/ci.yml and .github/workflows/nightly.yml
